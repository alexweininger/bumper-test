name: Bump version after release

# Run when release is published, or manually triggered
on:
  release:
    types: [published]
  workflow_dispatch:

jobs:
  bump:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Bump version
        uses: alexweininger/bump-prerelease-version@main
      
      - name: Create pull request
        uses: peter-evans/create-pull-request@v4
        with:
          title: ${{ env.MESSAGE }}
          body: Automatically created by ${{ env.RUN_LINK }}
          commit-message: ${{ env.MESSAGE }}
          branch: bump/v${{ steps.bump.outputs.new-version }}
          base: main
          author: GitHub <noreply@github.com>
        env:
          RUN_LINK: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}
          MESSAGE: Bump version after release
